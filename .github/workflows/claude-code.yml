name: Claude Code Simple Test

on:
  workflow_dispatch:  # Manual execution only
  push:
    branches: [ main ]
    paths:
      - '.github/workflows/claude-code.yml'

jobs:
  simple-test:
    name: Basic Claude Code CLI Test
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Claude Code CLI
        run: |
          echo "Installing Claude Code CLI..."
          npm install -g @anthropic-ai/claude-code
          echo "✅ Installation completed"

      - name: Verify Claude Code CLI
        run: |
          echo "Checking Claude Code CLI version..."
          claude-code --version
          echo "✅ Version check completed"

      - name: Test CLI Help
        run: |
          echo "Testing Claude Code CLI help command..."
          claude-code --help
          echo "✅ Help command completed"

      - name: Generate simple report
        run: |
          echo "## Simple Claude Code CLI Test Results" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Node.js 20 setup completed" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Claude Code CLI installed successfully" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ CLI version command executed" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ CLI help command executed" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Next step**: Test authentication with MAX plan credentials" >> $GITHUB_STEP_SUMMARY