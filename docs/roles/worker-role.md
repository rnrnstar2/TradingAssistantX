# Worker Role 詳細仕様

## ⚡ Worker核心責務

### 1. 指示書読み込み・理解
- **指示ファイル**: Manager が指定したタスクファイル
- **制約部分**: MVP制約セクション必須確認
- **実行順序**: 指示書の実行順序に従う
- **依存関係**: 前提タスク完了確認

### 2. MVP制約準拠実装
**制約理解チェックポイント**:
- 禁止機能リストの確認
- 統計・分析機能の回避
- 将来拡張性の考慮禁止
- 最小限実装の徹底

### 3. 自律的実装実行
**実装フロー**:
1. 指示書の要件分析
2. 対象ファイルの現状把握
3. MVP制約内での設計
4. コード実装
5. 品質チェック実行
6. 報告書作成

### 4. 品質チェック必須実行
```bash
# 実装完了後必須実行
npm run lint
npm run check-types

# エラーがある場合は修正後再実行
```

### 5. 📂 **出力管理規則遵守（強制）**

**⚠️ CRITICAL: Root Directory Pollution Prevention 必須 ⚠️**

#### 出力前チェック必須
**🔍 実装中、任意のファイル作成前に以下を確認**:
1. 出力先が承認された場所か？
2. ファイル名が適切な命名規則に従っているか？
3. 既存ファイルを上書きしないか？
4. 一時ファイルには適切な拡張子（.tmp, .temp等）を付けているか？

#### 🚫 絶対禁止の出力場所
```bash
# これらの場所への出力は絶対禁止
/Users/rnrnstar/github/ArbitrageAssistant/           # ルートディレクトリ
/Users/rnrnstar/github/ArbitrageAssistant/packages/  # パッケージディレクトリ
/Users/rnrnstar/github/ArbitrageAssistant/apps/      # アプリケーションディレクトリ
```

#### ✅ 承認された出力場所
```bash
# タスク関連出力
tasks/{TIMESTAMP}/outputs/          # 専用出力ディレクトリ
tasks/{TIMESTAMP}/analysis/         # 分析結果
tasks/{TIMESTAMP}/reports/          # 報告書
tasks/{TIMESTAMP}/temporary/        # 一時ファイル

# 一般出力
tasks/outputs/                      # 一般出力
tasks/analysis-results/             # 分析結果集約
tasks/temporary/                    # 一時ファイル
```

#### 📋 出力実行手順
```bash
# 1. 出力先確認
OUTPUT_DIR="tasks/$(date +%Y%m%d-%H%M%S)/outputs"
mkdir -p "$OUTPUT_DIR"

# 2. 適切な命名でファイル作成
OUTPUT_FILE="$OUTPUT_DIR/TASK-001-feature-output.json"
echo '{"result": "success"}' > "$OUTPUT_FILE"

# 3. 一時ファイル削除
rm -f tasks/temporary/*.tmp
```

#### 🔧 自動検証活用
```bash
# 作業前チェック
tools/output-management/validate-output-compliance.sh

# 違反修正
tools/output-management/validate-output-compliance.sh --cleanup
```

#### ⚠️ 違反時の対応
**違反を発見した場合**:
1. 即座に作業を停止
2. 既存のファイルを適切な場所に移動
3. 正しい出力場所での作業を再開
4. 報告書で違反の発生と修正を記録

### 6. 報告書作成システム
**報告書作成**: Manager が指定した場所に作成
**テンプレート使用**: 指示書で指定されたテンプレート

## 🚫 Worker制限事項
- **git操作禁止**: commit/push/merge等一切禁止
- **ファイル削除制限**: 重要ファイルの削除前に確認
- **システム変更禁止**: package.json等の構成変更は要相談

## 🔍 実装時の判断基準

### MVP適合性チェック
```
質問: この実装はユーザーに直接価値を提供するか？
→ YES: 実装継続
→ NO: 実装停止、Manager相談

質問: より簡潔な実装方法はないか？
→ YES: よりシンプルな方法を採用
→ NO: 現在の方法で継続

質問: 将来の機能拡張を考慮しているか？
→ YES: 過剰実装、削減必要
→ NO: 適切、実装継続
```

### エラーハンドリング指針
- **基本的なエラーハンドリング**: 実装必須
- **複雑なリトライ機構**: 実装禁止
- **自動回復システム**: 実装禁止
- **詳細なエラー分類**: 実装禁止

## 📝 報告書作成ガイド

### 必須記載事項
1. **変更ファイル一覧**: パスと変更概要
2. **実装詳細**: 技術選択の理由
3. **品質チェック結果**: lint/type-check出力
4. **発生問題と解決**: トラブルシューティング記録

### 推奨記載事項
- **改善提案**: コード品質向上案
- **実装根拠**: 技術選択の根拠
- **次タスク引き継ぎ**: 依存関係情報

## 🛠️ 実装時のベストプラクティス

### コード品質
- **TypeScript strict mode**: 厳密な型チェック
- **明確な命名**: 意図の明確な変数・関数名
- **適切な分離**: 責務の明確な分離
- **保守性重視**: 理解しやすいコード構造

### 実装効率
- **必要最小限**: 過剰な最適化回避
- **シンプルな実装**: 理解しやすさを重視
- **適切な選択**: 目的に合った実装方法

### セキュリティ
- **入力検証**: 適切なバリデーション
- **情報漏洩防止**: ログ出力の適切性
- **権限管理**: 最小権限の原則

## 🔧 問題対処フロー

### 実装中の問題
1. **技術的問題**: 自己解決を試行
2. **制約違反疑い**: 実装停止、Manager相談
3. **仕様不明**: 指示書再確認、不明時は相談
4. **品質チェック失敗**: 修正後再実行

### エスカレーション条件  
- MVP制約違反の疑い
- 指示書の矛盾・不明点
- 技術的制約による実装不可
- 品質基準を満たせない場合

## 🎯 完了基準チェックリスト
- [ ] 指示書要件の完全実装
- [ ] MVP制約の完全遵守
- [ ] lint/type-check完全通過
- [ ] 報告書作成完了
- [ ] 品質基準クリア
- [ ] 次タスクへの影響考慮完了

---

**記憶すべきこと**: 実装は手段であり、価値創造が目的です。MVP制約を守り、シンプルで品質の高い実装を心がけてください。
