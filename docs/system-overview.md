# TradingAssistantX システム概要

## 1. ビジョンと理想像

### 🎯 ビジョン
完全自律型の X 投資教育アカウント成長システム。人間の介入を最小限に、Claude が自律的に考え、判断し、実行することで、継続的に価値ある投資教育コンテンツを提供し続ける。

### 目標
X（Twitter）での価値創造による成長。投資初心者にも理解しやすい、質の高い教育コンテンツを提供し、フォロワーの投資リテラシー向上へ貢献する。

### 💡 システムの理想像

#### 自律的成長エンジン
- アカウントの現状を常に把握し、次の成長に必要な要素を自己分析
- フォロワーの反応やトレンドを学習し、最適な投稿戦略を自動更新
- 失敗からも学び、次回の投稿品質を継続的に改善

#### 自律ループシステム
- **1 日 15 回の定時実行**: 最適投稿時間（朝 7-8 時、昼 12 時、夕方 18-19 時、夜 21-23 時）に自律実行
- **data/ディレクトリ中心**: 各ループが前回学習を活用し、継続的成長を実現
- **コンテキスト最適化**: Claude Code SDK 向けに必要最小限の高品質データのみ保持
- **動的データクレンジング（強化版）**:
  - 実行毎に全ファイルを要件定義と照合
  - 要件定義にないファイルは即座に削除
  - 構造保持: 要件定義の構造から逸脱したファイルは作成不可

#### インテリジェントな意思決定
- **AI 駆動の全自動プロセス**: 人間の指示を待たず自律的に判断・実行
- **適応的戦略切替**: 状況に応じて柔軟に戦略を変更
- **機会発見**: 人間では気づかない成長機会を自動発見

### 実行原則
- **Claude主導**: 現在状況を分析し、最適なアクションを自律判断
- **品質重視**: 制限なく高品質な実装
- **データ駆動**: `data/`配下YAML設定による制御

## 2. システムアーキテクチャ

### 🏗️ アーキテクチャビジョン

#### 完全疎結合設計
```
データソース層: 無限に拡張可能な情報源
     ↓
知能層: 文脈理解と価値判断
     ↓
創造層: 独自の視点での価値創造
     ↓
成長層: 継続的な学習と最適化
```

### システム構成
- **Core**: 自律実行エンジン (`src/core/`)
  - `autonomous-executor.ts`: 自律実行エンジン
  - `decision-engine.ts`: 意思決定エンジン
  - `loop-manager.ts`: ループ実行管理
- **Collectors**: データ収集 (`src/collectors/`)
  - `rss-collector.ts`: RSS収集（MVP）
  - `playwright-account.ts`: アカウント分析専用
  - `base-collector.ts`: 基底クラス（疎結合設計）
- **Services**: ビジネスロジック (`src/services/`)
  - `content-creator.ts`: 投稿コンテンツ生成
  - `data-optimizer.ts`: データ最適化・クレンジング
  - `x-poster.ts`: X API投稿
- **Data**: YAML設定管理 (`data/`)

### 疎結合設計の特徴
- **データソース独立性**: 各Collectorは完全に独立して動作、相互依存なし
- **統一インターフェース**: CollectionResult型による抽象化で、新規データソース追加が容易
- **戦略的切り替え**: YAML ファイルの設定変更だけで、データソースの有効/無効を制御
- **拡張性重視**: 新しい Collector を追加しても既存コードへの影響を最小化

### MVP構成
- **Phase 1 (MVP)**: RSS Collector のみで投資教育コンテンツを収集・生成
- **将来拡張**: API、Community、Web スクレイピングなど多様なデータソースを段階的に追加

## 3. ブランディング戦略

### 🎨 成長段階別ブランディング

#### 初期段階（0-1000 フォロワー）
- 単一専門テーマに集中
- 推奨：「投資初心者向け基礎教育」特化
- 投稿の 80%を同一テーマカテゴリに統一
- 一貫したトーン：親しみやすく、分かりやすい解説

#### 成長段階（1000-5000 フォロワー）
- 関連テーマに段階的拡張
- 核となるテーマ（60%）+ 関連テーマ（40%）
- 専門性を保ちながら幅を広げる

#### 確立段階（5000+フォロワー）
- 多様なテーマ対応
- 現在の意思決定フローを適用

## 4. Claude Code SDK 意思決定カタログ

### 🧠 自律的意思決定の構造
Claude Code SDK が精度の高い自律的判断を行うため、利用可能な選択肢を体系化。各実行ループで最適なアクションを選択できる構造化された決定フレームワーク。

### 📋 利用可能なアクション・カタログ

#### 1. データ収集戦略
- **RSS 集中収集** (`collectors/rss-collector.ts`)
  - 適用条件: 安定した情報収集が必要、API 制限回避
  - 効果: 構造化された高品質データ、継続的更新
- **アカウント分析** (`collectors/playwright-account.ts`)
  - 適用条件: 自己状況把握、戦略調整時
  - 効果: フォロワー数・エンゲージメント率の正確な把握
- **複合データ収集** (将来拡張)
  - 適用条件: 多角的な情報が必要な重要トピック
  - 効果: より深い洞察、独自性の高いコンテンツ

#### 2. コンテンツ生成戦略
- **教育重視型** (`services/content-creator.ts`)
  - 適用条件: フォロワーが初心者中心、学習ニーズ高
  - 効果: 信頼性向上、長期的フォロワー獲得
- **トレンド対応型**
  - 適用条件: 話題性の高いニュース、瞬間的注目度重視
  - 効果: 短期的エンゲージメント向上、新規フォロワー獲得
- **分析特化型**
  - 適用条件: 市場動向が複雑、専門的解説が求められる
  - 効果: 権威性向上、専門性の認知

#### 3. 投稿タイミング戦略
- **定時投稿** (`data/config/posting-times.yaml`)
  - 適用条件: 安定したフォロワー習慣形成
  - 効果: 継続的エンゲージメント、習慣化促進
- **機会的投稿**
  - 適用条件: 重要ニュース発生、市場急変時
  - 効果: リアルタイム価値提供、注目度最大化
- **最適化投稿**
  - 適用条件: エンゲージメントデータ分析後
  - 効果: 時間帯別最適化、ROI 最大化

### 🎯 意思決定フローチャート

```
自律実行開始
     ↓
[1] 現在状況分析 (account-status.yaml読み込み)
     ↓
[2] ブランド一貫性チェック + 戦略選択
     ├── フォロワー数 < 1000 →
     │    └── ブランドテーマ固定（投資基礎教育のみ）+ 定時投稿
     ├── フォロワー数 1000-5000 →
     │    ├── 核テーマ（60%確率）→ 投資基礎教育
     │    └── 関連テーマ（40%確率）→ 市場分析・銘柄解説
     ├── フォロワー数 > 5000 → 既存の動的戦略適用
     └── 緊急時（重要ニュース）→ 分析特化型（全段階共通）
     ↓
[3] データ収集実行 (選択されたCollector起動)
     ↓
[4] コンテンツ生成 (選択された戦略でcontent-creator実行)
     ↓
[5] 品質確認・投稿実行 (x-poster.ts)
     ↓
[6] 結果記録・学習データ更新 (data/learning/)
```

### 🔀 判断基準とマッピング

#### アカウント状態による分岐
- **成長初期段階**: RSS 集中 + 教育重視 + 定時投稿
- **成長軌道段階**: 複合収集 + バランス型 + 最適化投稿
- **確立段階**: 戦略的収集 + 分析特化 + 機会的投稿

#### エンゲージメントによる分岐
- **低エンゲージメント**: トレンド対応強化、投稿時間再調整
- **高エンゲージメント**: 現在戦略維持、質的向上集中
- **変動大**: A/B テスト的戦略切り替え

#### 外部環境による分岐
- **重要経済指標発表**: 即座に分析特化型へ切り替え
- **市場急変**: トレンド対応型 + 機会的投稿
- **通常時**: データ駆動の最適戦略継続

### 🏗️ src ディレクトリとの対応
```
決定エンジン (core/decision-engine.ts)
     ↓ 戦略選択
各種コンポーネント実行:
├── collectors/ → データ収集選択肢実行
├── services/ → コンテンツ生成・投稿実行
├── utils/ → 支援機能（圧縮、YAML管理、整合性検証）
└── data/ → 判断材料・結果記録
```

## 5. 主要コンポーネント

### 🔧 Core Components
- **AutonomousExecutor**: 自律実行制御
  - 全体的な実行フローの管理
  - 各コンポーネントの協調動作制御
  - エラーハンドリングとリトライ機構

- **ActionSpecificCollector**: 情報収集
  - 動的データ収集戦略の実装
  - 複数のデータソースからの統合収集
  - 収集データの品質評価と選別

- **DecisionEngine**: 判断エンジン
  - 状況分析と最適戦略の決定
  - ブランド一貫性の維持
  - 成長段階に応じた戦略切り替え

### ワークフロー最適化

#### 🎯 トピック特化プロセス
- **フェーズ1**: 市場スキャン→トピック選定
- **フェーズ2**: 特化キーワード→情報収集
- **フェーズ3**: 品質評価→実行判断

#### 🚀 システム改善履歴
- **実行時間**: 240秒→900秒（15分）
- **情報源**: 制限解除→無制限
- **処理方式**: 最適化された実装
- **精度目標**: 充足度90%達成

### 開発・実行環境
- TypeScript strict mode必須
- YAML駆動による設定管理
- 疎結合設計による高い拡張性

### 📋 コマンドリファレンス
```bash
pnpm dev        # 単発実行
pnpm test       # テスト実行
pnpm lint       # 品質チェック
```

---

**究極の目標**: 人間を超える洞察力と継続力を持つ、真に自律的な投資教育コンテンツクリエーターの実現