# TASK-001: ツイート選択基準のアクション別最適化

## 🎯 **タスク概要**

`selection-endpoint.ts`における各アクション（いいね・リツイート・引用リツイート）の選択基準を、それぞれの戦略的目的に最適化する。

### 📊 **現在の問題**
- 全アクションで同じ一般的な選択基準を使用
- いいね：フォロワー獲得視点の不足
- 引用リツイート：品質管理・言及可能性の不足  
- リツイート：価値判定の抽象性

## 🎯 **実装目的**

### 各アクションの戦略的目的
1. **いいね**: 自分のアカウントに興味がありそうなユーザーへのアプローチ
2. **リツイート**: その投稿に価値があると判断しフォロワーに共有
3. **引用リツイート**: 自分が価値を追加できる内容で品質管理を徹底

## 📂 **実装対象ファイル**
- **主要**: `src/claude/endpoints/selection-endpoint.ts:252-307`
- **参考**: `src/claude/prompts/templates/search.template.ts:28-95`

## 🔧 **実装要件**

### 1. buildSelectionPrompt関数の最適化（lines 252-307）

現在の汎用的な`purposeDescription`を各アクション特化型に変更：

```typescript
// 現在（修正対象）
const purposeDescription = {
  like: 'いいね対象として最適なツイートを選択',
  retweet: 'リツイート対象として最適なツイートを選択', 
  quote_tweet: '引用リツイート対象として最適なツイートを選択'
};

// 修正後（アクション特化）
const purposeDescription = {
  like: '関係構築のために、投資教育に興味がありそうなユーザーの投稿を選択',
  retweet: 'フォロワーにとって価値がある投資教育コンテンツを選択',
  quote_tweet: '自分の専門知識で価値を追加できる投資教育投稿を選択'
};
```

### 2. アクション別選択基準の実装

**いいね選択基準**:
```markdown
【いいね選択基準】
- 関係構築可能性: そのユーザーが投資教育アカウントに興味を持ちそうか（90%）
- ユーザーエンゲージメント: そのユーザーの平均エンゲージメント率
- コンテンツ親和性: 投資教育との関連性
- アプローチ適切性: いいねが適切なアプローチ手段か
- リスク評価: 炎上リスクや誤解リスクの最小化（10%）
```

**リツイート選択基準**:
```markdown
【リツイート選択基準】
- 教育的価値: フォロワーの投資知識向上への貢献度（40%）
- 情報信頼性: 投稿内容の正確性と情報源の信頼度（30%）
- エンゲージメント予測: RT後のいいね・RT・リプライ拡散予測（20%）
- ブランド整合性: 自分のアカウントとの価値観一致（10%）
```

**引用リツイート選択基準**:
```markdown
【引用リツイート選択基準】
- 価値追加可能性: 自分の専門知識で補足・解説できるか（50%）
- 品質管理: RT自体が自分の意見として認識されるリスク管理（30%）
- 教育効果: 引用コメントで教育効果を高められるか（15%）
- エンゲージメント予測: 引用RT後の反応予測（5%）
```

### 3. プロンプト構造の最適化

各アクション用の詳細基準をプロンプトに組み込み：

```typescript
// アクション別基準詳細をプロンプトに追加
const actionSpecificCriteria = {
  like: `
【いいね戦略的基準】
- 対象ユーザー分析: フォロワー数、投稿傾向、エンゲージメント率
- 関係構築予測: いいね後のフォロー可能性、継続的関係性
- アプローチタイミング: 投稿時間とユーザー活動パターンの適合`,
  
  retweet: `
【リツイート戦略的基準】
- フォロワー価値: この情報がフォロワーの投資判断に役立つか
- 情報鮮度: 市場変動や規制変更などタイムリーな価値
- 信頼性担保: RT=推奨として認識される責任を負えるか`,
  
  quote_tweet: `
【引用リツイート戦略的基準】
- 付加価値創造: 元投稿に自分の専門知識で何を追加できるか
- 品質責任: 引用RT=自分の意見として扱われることの責任
- 議論促進: 建設的な議論を促進できる内容か`
};
```

## 🚀 **実装手順**

### Step 1: 現在のコード分析
1. `buildSelectionPrompt`関数の現在の構造を理解
2. 各アクションで同じ基準が使われている箇所を特定
3. プロンプト内の基準記述部分を特定

### Step 2: アクション別基準の実装
1. `purposeDescription`の修正
2. 各アクション用の詳細基準オブジェクトを作成
3. プロンプト内への基準統合ロジック実装

### Step 3: プロンプト構造最適化
1. 基準の重み付けを明確化
2. Claude判断精度向上のためのプロンプト調整
3. トークン効率化の維持

### Step 4: 検証・テスト
1. TypeScript型チェック通過確認
2. 各アクションでのプロンプト出力確認
3. 基準が正しく反映されているか検証

## ⚠️ **実装制約**

### MVP制約遵守
- 過剰な統計機能や分析機能の追加禁止
- シンプルな基準適用ロジックに限定
- 実際に使用する機能のみ実装

### 品質要件
- TypeScript strict mode通過必須
- 既存のインターフェース維持
- エラーハンドリング継続
- 既存テストとの互換性維持

### 出力管理
- 修正対象: `src/claude/endpoints/selection-endpoint.ts`のみ
- ルートディレクトリへの出力禁止
- 分析レポートは`tasks/20250730_150030/reports/`配下に作成

## 📋 **期待される成果**

### 直接的効果
- いいね：フォロワー獲得率の向上
- リツイート：フォロワーエンゲージメント向上  
- 引用リツイート：教育的価値と品質の両立

### システム的効果
- 各アクションの戦略的目的の明確化
- Claude判断精度の向上
- 投資教育アカウントとしてのブランド価値向上

## 🔍 **完了条件**

1. ✅ `buildSelectionPrompt`関数が各アクション別に最適化されている
2. ✅ 各アクションの選択基準が戦略的目的に適合している
3. ✅ TypeScript型チェック・lint通過
4. ✅ 既存のインターフェース・API仕様の維持
5. ✅ プロンプト出力でアクション別基準が確認できる

## 📋 **報告書作成要件**

実装完了後、以下を含む報告書を作成：
- **実装概要**: 修正された選択基準の詳細
- **Before/After**: プロンプト出力の比較
- **検証結果**: TypeScript・lint・動作確認結果
- **期待効果**: 各アクション最適化による予想される改善効果

---

**出力先**: `tasks/20250730_150030/reports/REPORT-001-optimize-action-selection-criteria.md`