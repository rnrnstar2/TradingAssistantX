# TASK-004: Áµ±Âêà„ÉÜ„Çπ„Éà„ÉªÂãï‰ΩúÊ§úË®ºÂÆüË£Ö

## üéØ ÂÆüË£ÖÁõÆÊ®ô
TASK-001„Äú003„ÅßÂÆüË£Ö„Åï„Çå„ÅüÊñ∞„Åó„ÅÑÂ§öÊßòÊÉÖÂ†±Ê∫ê„Ç∑„Çπ„ÉÜ„É†„ÅÆÁµ±Âêà„ÉÜ„Çπ„Éà„ÇíÂÆüÊñΩ„Åó„ÄÅ„Ç∑„Çπ„ÉÜ„É†ÂÖ®‰Ωì„ÅÆÂãï‰Ωú„ÇíÊ§úË®º„Åó„Åæ„Åô„ÄÇ

## üìä Ê§úË®ºÂØæË±°„Ç∑„Çπ„ÉÜ„É†
- **TASK-001**: Â§öÊßò„Å™ÊÉÖÂ†±Ê∫êÁµ±Âêà„Ç∑„Çπ„ÉÜ„É†ÔºàMultiSourceCollectorÔºâ
- **TASK-002**: ActionSpecificCollectorÊã°ÂºµÂÆüË£Ö
- **TASK-003**: Ë®≠ÂÆö„Éï„Ç°„Ç§„É´Êõ¥Êñ∞„ÉªÊñ∞ÊÉÖÂ†±Ê∫êÂØæÂøú

## üöÄ ÂÆüË£ÖË¶Å‰ª∂

### 1. „ÉÜ„Çπ„Éà„Éï„Ç°„Ç§„É´‰ΩúÊàê

#### Êñ∞Ë¶è‰ΩúÊàê„Éï„Ç°„Ç§„É´
```
tests/integration/multi-source-integration.test.ts - Áµ±Âêà„ÉÜ„Çπ„Éà
tests/unit/multi-source-collector.test.ts - Âçò‰Ωì„ÉÜ„Çπ„Éà
tests/unit/action-specific-collector-extended.test.ts - Êã°ÂºµÊ©üËÉΩ„ÉÜ„Çπ„Éà  
tests/e2e/information-collection-workflow.test.ts - E2E„ÉÜ„Çπ„Éà
```

#### Êó¢Â≠ò„ÉÜ„Çπ„ÉàÊõ¥Êñ∞
```
tests/unit/action-specific-collector.test.ts - Êó¢Â≠ò„ÉÜ„Çπ„Éà„ÅÆÊõ¥Êñ∞
tests/integration/action-specific-integration.test.ts - Áµ±ÂêàÊ©üËÉΩ„ÅÆÊõ¥Êñ∞
```

### 2. Áµ±Âêà„ÉÜ„Çπ„ÉàÂÆüË£Ö

#### multi-source-integration.test.ts
```typescript
import { describe, it, expect, beforeAll, afterAll } from 'vitest';
import { MultiSourceCollector } from '../../src/lib/multi-source-collector';
import { ActionSpecificCollector } from '../../src/lib/action-specific-collector';

describe('Multi-Source Information Collection Integration', () => {
  let multiSourceCollector: MultiSourceCollector;
  let actionSpecificCollector: ActionSpecificCollector;

  beforeAll(async () => {
    // „ÉÜ„Çπ„ÉàÁí∞Â¢É„ÅÆ„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
    multiSourceCollector = new MultiSourceCollector();
    actionSpecificCollector = new ActionSpecificCollector(undefined, true);
  });

  describe('RSS Integration', () => {
    it('should collect information from RSS sources', async () => {
      const results = await multiSourceCollector.collectFromRSS(['yahoo_finance', 'reuters']);
      
      expect(results.data).toBeDefined();
      expect(results.data.length).toBeGreaterThan(0);
      expect(results.source).toBe('rss');
      expect(results.metadata.requestCount).toBeGreaterThan(0);
    });

    it('should handle RSS timeout gracefully', async () => {
      const results = await multiSourceCollector.collectFromRSS(['invalid_rss_source']);
      
      expect(results.data).toBeDefined();
      expect(results.data.length).toBe(0); // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ„Éá„Éº„Çø
      expect(results.metadata.requestCount).toBe(0);
    });
  });

  describe('API Integration', () => {
    it('should collect information from API sources', async () => {
      const apiConfig = {
        sources: ['alpha_vantage', 'coingecko'],
        endpoints: ['prices', 'market_data']
      };
      
      const results = await multiSourceCollector.collectFromAPIs(apiConfig);
      
      expect(results.data).toBeDefined();
      expect(results.source).toBe('api');
      
      if (results.data.length > 0) {
        expect(results.data[0]).toHaveProperty('relevanceScore');
        expect(results.data[0]).toHaveProperty('source');
        expect(results.data[0]).toHaveProperty('content');
      }
    });

    it('should respect API rate limits', async () => {
      const startTime = Date.now();
      
      const promises = Array(5).fill(null).map(() => 
        multiSourceCollector.collectFromAPIs({
          sources: ['alpha_vantage'],
          endpoints: ['stock_quote']
        })
      );
      
      const results = await Promise.allSettled(promises);
      const endTime = Date.now();
      
      // „É¨„Éº„ÉàÂà∂Èôê„Å´„Çà„ÇäÈÅ©Âàá„Å™ÈñìÈöî„ÅßÂÆüË°å„Åï„Çå„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç
      expect(endTime - startTime).toBeGreaterThan(5000); // ÊúÄ‰Ωé5Áßí
      expect(results.every(r => r.status === 'fulfilled')).toBe(true);
    });
  });

  describe('Community Integration', () => {
    it('should collect information from community sources', async () => {
      const results = await multiSourceCollector.collectFromCommunity(['reddit']);
      
      expect(results.data).toBeDefined();
      expect(results.source).toBe('community');
      
      // „Ç≥„Éü„É•„Éã„ÉÜ„Ç£„Éá„Éº„Çø„ÅÆÂìÅË≥™„ÉÅ„Çß„ÉÉ„ÇØ
      results.data.forEach(item => {
        expect(item.content.length).toBeGreaterThan(20);
        expect(item.relevanceScore).toBeGreaterThan(0);
        expect(item.metadata).toBeDefined();
      });
    });
  });

  describe('ActionSpecificCollector Extended Integration', () => {
    it('should integrate multiple sources for original_post', async () => {
      const mockContext = createMockIntegratedContext();
      
      const result = await actionSpecificCollector.collectForAction(
        'original_post',
        mockContext,
        85
      );
      
      expect(result.actionType).toBe('original_post');
      expect(result.results).toBeDefined();
      expect(result.sufficiencyScore).toBeGreaterThan(0);
      expect(result.qualityMetrics).toBeDefined();
      
      // Â§öÊßò„Å™ÊÉÖÂ†±Ê∫ê„Åã„Çâ„ÅÆÂèéÈõÜ„ÇíÁ¢∫Ë™ç
      const sources = new Set(result.results.map(r => r.source));
      expect(sources.size).toBeGreaterThan(1); // Ë§áÊï∞ÊÉÖÂ†±Ê∫ê
    });

    it('should fallback to X when multi-source fails', async () => {
      const mockContext = createMockIntegratedContext();
      
      // Â§öÊßòÊÉÖÂ†±Ê∫ê„ÇíÁÑ°ÂäπÂåñ
      const collector = new ActionSpecificCollector(undefined, false);
      
      const result = await collector.collectForAction(
        'original_post',
        mockContext,
        85
      );
      
      expect(result.actionType).toBe('original_post');
      expect(result.results).toBeDefined();
      expect(result.sufficiencyScore).toBeGreaterThan(0);
    });

    it('should optimize source selection by action type', async () => {
      const mockContext = createMockIntegratedContext();
      
      // Áï∞„Å™„Çã„Ç¢„ÇØ„Ç∑„Éß„É≥„Çø„Ç§„Éó„ÅßÊÉÖÂ†±Ê∫ê„ÅåÊúÄÈÅ©Âåñ„Åï„Çå„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç
      const originalResult = await actionSpecificCollector.collectForAction('original_post', mockContext);
      const replyResult = await actionSpecificCollector.collectForAction('reply', mockContext);
      
      // „Ç¢„ÇØ„Ç∑„Éß„É≥„Çø„Ç§„ÉóÂà•„ÅÆÊúÄÈÅ©Âåñ„ÅåÂèçÊò†„Åï„Çå„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç
      expect(originalResult.strategyUsed.sources).toBeDefined();
      expect(replyResult.strategyUsed.sources).toBeDefined();
      
      // original_post„ÅØÂ§öÊßò„Å™ÊÉÖÂ†±Ê∫ê„ÄÅreply„ÅØ„Ç≥„Éü„É•„Éã„ÉÜ„Ç£ÈáçË¶ñ
      const originalSources = originalResult.results.map(r => r.source);
      const replySources = replyResult.results.map(r => r.source);
      
      expect(originalSources.length).toBeGreaterThanOrEqual(replySources.length);
    });
  });

  describe('Quality Evaluation Integration', () => {
    it('should evaluate multi-source quality correctly', async () => {
      const mockResults = [
        { source: 'rss', relevanceScore: 0.9, content: 'RSS content', id: 'rss-1', type: 'news', timestamp: Date.now(), metadata: {} },
        { source: 'api', relevanceScore: 0.95, content: 'API content', id: 'api-1', type: 'data', timestamp: Date.now(), metadata: {} },
        { source: 'community', relevanceScore: 0.7, content: 'Community content', id: 'comm-1', type: 'discussion', timestamp: Date.now(), metadata: {} }
      ];
      
      const mockContext = createMockIntegratedContext();
      const result = await actionSpecificCollector.collectForAction('original_post', mockContext);
      
      expect(result.qualityMetrics.relevanceScore).toBeGreaterThan(70);
      expect(result.qualityMetrics.credibilityScore).toBeGreaterThan(70);
      expect(result.qualityMetrics.overallScore).toBeGreaterThan(70);
    });
  });

  describe('Configuration Integration', () => {
    it('should load updated configuration correctly', async () => {
      const collector = new ActionSpecificCollector();
      
      expect(collector.config).toBeDefined();
      expect(collector.config.multiSources).toBeDefined();
      expect(collector.config.sourceSelection).toBeDefined();
    });

    it('should handle missing configuration gracefully', async () => {
      const collector = new ActionSpecificCollector('invalid-config-path.yaml');
      
      // „Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö„ÅßÂãï‰Ωú„Åô„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç
      expect(collector.config).toBeDefined();
      
      const mockContext = createMockIntegratedContext();
      const result = await collector.collectForAction('original_post', mockContext);
      
      expect(result.results).toBeDefined();
    });
  });

  afterAll(async () => {
    // „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„ÉóÂá¶ÁêÜ
  });
});

// „Éò„É´„Éë„ÉºÈñ¢Êï∞
function createMockIntegratedContext() {
  return {
    account: {
      currentState: {
        timestamp: new Date().toISOString(),
        followers: { current: 100, change_24h: 5, growth_rate: '5%' },
        engagement: { avg_likes: 10, avg_retweets: 5, engagement_rate: '2%' },
        performance: { posts_today: 2, target_progress: '40%', best_posting_time: '12:00' },
        health: { status: 'healthy', api_limits: 'normal', quality_score: 85 },
        recommendations: [],
        healthScore: 85
      },
      recommendations: [],
      healthScore: 85
    },
    market: {
      trends: [],
      opportunities: [],
      competitorActivity: []
    },
    actionSuggestions: [],
    timestamp: Date.now()
  };
}
```

### 3. „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„Éà

#### performance-integration.test.ts
```typescript
describe('Performance Integration Tests', () => {
  it('should complete multi-source collection within time limit', async () => {
    const startTime = Date.now();
    
    const collector = new ActionSpecificCollector(undefined, true);
    const mockContext = createMockIntegratedContext();
    
    const result = await collector.collectForAction('original_post', mockContext, 85);
    
    const endTime = Date.now();
    const executionTime = endTime - startTime;
    
    expect(executionTime).toBeLessThan(90000); // 90ÁßíÂà∂Èôê
    expect(result.results.length).toBeGreaterThan(0);
  });

  it('should handle concurrent collections efficiently', async () => {
    const collector = new ActionSpecificCollector(undefined, true);
    const mockContext = createMockIntegratedContext();
    
    const concurrentPromises = [
      collector.collectForAction('original_post', mockContext),
      collector.collectForAction('quote_tweet', mockContext),
      collector.collectForAction('retweet', mockContext),
      collector.collectForAction('reply', mockContext)
    ];
    
    const startTime = Date.now();
    const results = await Promise.allSettled(concurrentPromises);
    const endTime = Date.now();
    
    expect(results.every(r => r.status === 'fulfilled')).toBe(true);
    expect(endTime - startTime).toBeLessThan(120000); // 2ÂàÜ‰ª•ÂÜÖ
  });
});
```

### 4. E2E„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÉÜ„Çπ„Éà

#### information-collection-workflow.test.ts
```typescript
describe('Information Collection Workflow E2E', () => {
  it('should execute full multi-source workflow', async () => {
    // 1. Ë®≠ÂÆöË™≠„ÅøËæº„Åø
    const collector = new ActionSpecificCollector();
    expect(collector.config).toBeDefined();
    
    // 2. ÊÉÖÂ†±ÂèéÈõÜÂÆüË°å
    const mockContext = createMockIntegratedContext();
    const result = await collector.collectForAction('original_post', mockContext, 85);
    
    // 3. ÁµêÊûúÊ§úË®º
    expect(result.actionType).toBe('original_post');
    expect(result.results.length).toBeGreaterThan(0);
    expect(result.sufficiencyScore).toBeGreaterThan(0);
    
    // 4. ÂìÅË≥™Âü∫Ê∫ñÁ¢∫Ë™ç
    expect(result.qualityMetrics.relevanceScore).toBeGreaterThan(70);
    expect(result.qualityMetrics.overallScore).toBeGreaterThan(70);
    
    // 5. ÂÆüË°åÊôÇÈñìÁ¢∫Ë™ç
    expect(result.executionTime).toBeLessThan(90000);
  });
});
```

### 5. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÉÜ„Çπ„Éà

#### error-handling.test.ts
```typescript
describe('Error Handling Integration', () => {
  it('should gracefully handle API failures', async () => {
    // „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÈöúÂÆ≥„Çí„Ç∑„Éü„É•„É¨„Éº„Éà
    const collector = new ActionSpecificCollector(undefined, true);
    const mockContext = createMockIntegratedContext();
    
    // APIÊé•Á∂öÂ§±Êïó„Çí„É¢„ÉÉ„ÇØ
    jest.spyOn(global, 'fetch').mockRejectedValue(new Error('Network error'));
    
    const result = await collector.collectForAction('original_post', mockContext);
    
    expect(result.results).toBeDefined();
    expect(result.sufficiencyScore).toBeGreaterThan(0); // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂãï‰Ωú
  });

  it('should handle configuration errors', async () => {
    const collector = new ActionSpecificCollector('non-existent-config.yaml');
    const mockContext = createMockIntegratedContext();
    
    const result = await collector.collectForAction('original_post', mockContext);
    
    expect(result.results).toBeDefined(); // „Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö„ÅßÂãï‰Ωú
  });
});
```

## üìã ÂÆüË£ÖÊâãÈ†Ü

### Phase 1: Âü∫Êú¨Áµ±Âêà„ÉÜ„Çπ„Éà
1. ÂêÑÊÉÖÂ†±Ê∫êÔºàRSS„ÄÅAPI„ÄÅ„Ç≥„Éü„É•„Éã„ÉÜ„Ç£Ôºâ„ÅÆÂçò‰Ωì„ÉÜ„Çπ„ÉàÂÆüË£Ö
2. ActionSpecificCollectorÊã°ÂºµÊ©üËÉΩ„ÅÆ„ÉÜ„Çπ„ÉàÂÆüË£Ö
3. Ë®≠ÂÆö„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø„ÉÜ„Çπ„Éà„ÅÆÂÆüË£Ö

### Phase 2: „Ç∑„Çπ„ÉÜ„É†Áµ±Âêà„ÉÜ„Çπ„Éà
1. Â§öÊßòÊÉÖÂ†±Ê∫ê„ÅÆÁµ±ÂêàÂãï‰Ωú„ÉÜ„Çπ„Éà
2. ÂìÅË≥™Ë©ï‰æ°„Ç∑„Çπ„ÉÜ„É†„ÅÆ„ÉÜ„Çπ„Éà
3. „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÊ©üËÉΩ„ÅÆ„ÉÜ„Çπ„Éà

### Phase 3: „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„Éà
1. ÂÆüË°åÊôÇÈñìÂà∂Èôê„ÉÜ„Çπ„Éà
2. ‰∏¶ÂàóÂá¶ÁêÜ„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„Éà
3. „É°„É¢„É™‰ΩøÁî®Èáè„ÅÆ„ÉÜ„Çπ„Éà

### Phase 4: E2E„ÉÜ„Çπ„Éà
1. ÂÆåÂÖ®„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÅÆ„ÉÜ„Çπ„Éà
2. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÅÆ„ÉÜ„Çπ„Éà
3. ÂÆüÈöõ„ÅÆÈÅãÁî®Áí∞Â¢É„Åß„ÅÆ„ÉÜ„Çπ„Éà

## ‚ö†Ô∏è Âà∂Á¥Ñ„ÉªÊ≥®ÊÑè‰∫ãÈ†Ö

### „ÉÜ„Çπ„ÉàÁí∞Â¢É
- ÂÆüÈöõ„ÅÆAPI„Å∏„ÅÆ„Ç¢„ÇØ„Çª„ÇπÂà∂Èôê„ÇíËÄÉÊÖÆ
- „É¢„ÉÉ„ÇØ/„Çπ„Çø„Éñ„ÅÆÈÅ©Âàá„Å™‰ΩøÁî®
- „ÉÜ„Çπ„Éà„Éá„Éº„Çø„ÅÆÁÆ°ÁêÜ

### „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπË¶Å‰ª∂
- 90ÁßíÂÆüË°åÂà∂Èôê„ÅÆÁ¢∫Ë™ç
- „É¨„Éº„ÉàÂà∂Èôê„ÅÆÈÅµÂÆàÁ¢∫Ë™ç
- „É°„É¢„É™„É™„Éº„ÇØ„ÅÆÊ§úË®º

### „Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë¶Å‰ª∂
- Ë™çË®ºÊÉÖÂ†±„ÅÆÈÅ©Âàá„Å™ÁÆ°ÁêÜ
- „ÉÜ„Çπ„ÉàÁí∞Â¢É„Åß„ÅÆAPIÂà∂ÈôêÁ¢∫Ë™ç

## ‚úÖ ÂÆå‰∫ÜÂü∫Ê∫ñ

1. **„ÉÜ„Çπ„Éà„Ç´„Éê„É¨„ÉÉ„Ç∏**
   - Êñ∞Ê©üËÉΩ„ÅÆ90%‰ª•‰∏ä„ÅÆ„Ç´„Éê„É¨„ÉÉ„Ç∏
   - Áµ±Âêà„ÉÜ„Çπ„Éà„ÅÆÂÖ®„Éë„Çπ
   - „Ç®„É©„Éº„Ç±„Éº„Çπ„ÅÆÁ∂≤ÁæÖÁöÑ„ÉÜ„Çπ„Éà

2. **„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂü∫Ê∫ñ**
   - 90ÁßíÂà∂ÈôêÂÜÖ„Åß„ÅÆÂÆüË°åÁ¢∫Ë™ç
   - „É¨„Éº„ÉàÂà∂Èôê„ÅÆÈÅµÂÆàÁ¢∫Ë™ç
   - ‰∏¶ÂàóÂá¶ÁêÜ„ÅÆÂäπÁéáÊÄßÁ¢∫Ë™ç

3. **ÂìÅË≥™Âü∫Ê∫ñ**
   - TypeScript strict modeÊ∫ñÊã†
   - ESLint/PrettierÈÄöÈÅé
   - ÂÆüÈöõ„ÅÆÈÅãÁî®Áí∞Â¢É„Åß„ÅÆÂãï‰ΩúÁ¢∫Ë™ç

## üìÅ Âá∫ÂäõÁÆ°ÁêÜ
- ‚úÖ ÊâøË™ç„Åï„Çå„ÅüÂá∫ÂäõÂ†¥ÊâÄ: `tasks/20250721_190718_information_source_expansion/outputs/`
- üö´ „É´„Éº„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™„Å∏„ÅÆÂá∫Âäõ„ÅØÁµ∂ÂØæÁ¶ÅÊ≠¢
- üìã ÂëΩÂêçË¶èÂâá: `TASK-004-{name}-output.{ext}` ÂΩ¢Âºè‰ΩøÁî®

## üìã Â†±ÂëäÊõ∏Ë¶Å‰ª∂
ÂÆüË£ÖÂÆå‰∫ÜÂæå„ÄÅ‰ª•‰∏ãÂÜÖÂÆπ„ÅßÂ†±ÂëäÊõ∏„Çí‰ΩúÊàêÔºö
- Áµ±Âêà„ÉÜ„Çπ„ÉàÁµêÊûú„ÅÆË©≥Á¥∞
- „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„ÉàÁµêÊûú
- Áô∫Ë¶ã„Åï„Çå„ÅüÂïèÈ°å„ÉªÂà∂Èôê‰∫ãÈ†Ö
- ÈÅãÁî®ÊôÇ„ÅÆÊé®Â•®‰∫ãÈ†Ö
- ‰ªäÂæå„ÅÆÊîπÂñÑÊèêÊ°à

---

**„ÉÜ„Çπ„ÉàÂìÅË≥™**: „Ç∑„Çπ„ÉÜ„É†ÂÖ®‰Ωì„ÅÆ‰ø°È†ºÊÄß„ÇíÊîØ„Åà„ÇãÈáçË¶Å„Å™Ê§úË®º„Éó„É≠„Çª„Çπ„Åß„Åô„ÄÇÂæπÂ∫ïÁöÑ„Å™„ÉÜ„Çπ„Éà„Å´„Çà„Çä„ÄÅÊú¨Áï™Áí∞Â¢É„Åß„ÅÆÂÆâÂÆöÂãï‰Ωú„Çí‰øùË®º„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ