# APIã‚­ãƒ¼å–å¾—ãƒ»è¨­å®š è©³ç´°æ‰‹é †æ›¸

## ğŸ¯ **ç›®æ¨™**
å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿APIã¨ã®æ¥ç¶šã«å¿…è¦ãªèªè¨¼æƒ…å ±ã‚’å–å¾—ãƒ»è¨­å®šã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿åé›†ã‚’å¯èƒ½ã«ã™ã‚‹

## â° **æ‰€è¦æ™‚é–“: 30åˆ†**

---

## ğŸ”‘ **å¿…é ˆAPIã‚­ãƒ¼å–å¾—æ‰‹é †**

### **1. Alpha Vantage APIï¼ˆæ ªå¼ãƒ»FXãƒ‡ãƒ¼ã‚¿ï¼‰**

#### **å–å¾—æ‰‹é †**:
1. https://www.alphavantage.co/support/#api-key ã«ã‚¢ã‚¯ã‚»ã‚¹
2. "GET YOUR FREE API KEY TODAY" ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ•ã‚©ãƒ¼ãƒ ã«ä»¥ä¸‹ã‚’å…¥åŠ›ï¼š
   ```
   First Name: [ã‚ãªãŸã®åå‰]
   Last Name: [ã‚ãªãŸã®å§“]
   Email: [æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹]
   Organization: Trading Analysis
   ```
4. "GET FREE API KEY" ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹ **APIã‚­ãƒ¼ã‚’ãƒ¡ãƒ¢**ï¼ˆä¾‹: `ABC123XYZ789`ï¼‰

#### **æä¾›ãƒ‡ãƒ¼ã‚¿**:
- æ ªå¼ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¾¡æ ¼
- FXãƒ¬ãƒ¼ãƒˆï¼ˆUSDJPYã€EURUSDç­‰ï¼‰
- æš—å·é€šè²¨ä¾¡æ ¼
- çµŒæ¸ˆæŒ‡æ¨™

---

### **2. CoinGecko APIï¼ˆæš—å·é€šè²¨ãƒ‡ãƒ¼ã‚¿ï¼‰**

#### **å–å¾—æ‰‹é †**:
1. https://www.coingecko.com/en/api/pricing ã«ã‚¢ã‚¯ã‚»ã‚¹
2. "Developer Plan" ã® "Get Started" ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
3. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼š
   ```
   Email: [æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹]
   Password: [å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰]
   ```
4. ãƒ¡ãƒ¼ãƒ«èªè¨¼ã‚’å®Œäº†
5. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ **APIã‚­ãƒ¼ã‚’å–å¾—**ï¼ˆä¾‹: `CG-xyz789abc123`ï¼‰

#### **æä¾›ãƒ‡ãƒ¼ã‚¿**:
- æš—å·é€šè²¨ä¾¡æ ¼ãƒ»ãƒœãƒªãƒ¥ãƒ¼ãƒ 
- ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
- å¸‚å ´ã‚­ãƒ£ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿

---

### **3. FRED APIï¼ˆçµŒæ¸ˆæŒ‡æ¨™ãƒ‡ãƒ¼ã‚¿ï¼‰**

#### **å–å¾—æ‰‹é †**:
1. https://fred.stlouisfed.org/docs/api/api_key.html ã«ã‚¢ã‚¯ã‚»ã‚¹
2. "Request an API Key" ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼ˆç„¡æ–™ï¼‰ï¼š
   ```
   Email: [æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹]
   Password: [ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰]
   First/Last Name: [æ°å]
   ```
4. "API Keys" ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ **æ–°ã—ã„APIã‚­ãƒ¼ã‚’ç”Ÿæˆ**
5. **APIã‚­ãƒ¼ã‚’ãƒ¡ãƒ¢**ï¼ˆä¾‹: `fred123abc789xyz`ï¼‰

#### **æä¾›ãƒ‡ãƒ¼ã‚¿**:
- GDPã€å¤±æ¥­ç‡ç­‰ã®çµŒæ¸ˆæŒ‡æ¨™
- é‡‘åˆ©ãƒ‡ãƒ¼ã‚¿
- ã‚¤ãƒ³ãƒ•ãƒ¬ç‡

---

## ğŸ”§ **ç’°å¢ƒå¤‰æ•°è¨­å®š**

### **1. ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§ä»¥ä¸‹ã‚’å®Ÿè¡Œï¼š

```bash
# .env.local ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
touch .env.local

# æ¨©é™è¨­å®šï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ï¼‰
chmod 600 .env.local
```

### **2. APIã‚­ãƒ¼è¨­å®š**

`.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®å†…å®¹ã‚’è¿½åŠ ï¼š

```bash
# å¿…é ˆAPIsï¼ˆç„¡æ–™ï¼‰
ALPHA_VANTAGE_API_KEY=ã“ã“ã«å–å¾—ã—ãŸAlpha Vantageã®APIã‚­ãƒ¼ã‚’å…¥åŠ›
COINGECKO_API_KEY=ã“ã“ã«å–å¾—ã—ãŸCoinGeckoã®APIã‚­ãƒ¼ã‚’å…¥åŠ›
FRED_API_KEY=ã“ã“ã«å–å¾—ã—ãŸFREDã®APIã‚­ãƒ¼ã‚’å…¥åŠ›

# å®Ÿãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹åŒ–
REAL_DATA_MODE=true

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼ˆå•é¡Œæ™‚ã«æœ‰åŠ¹ï¼‰
DEBUG_API=false
```

### **3. è¨­å®šä¾‹**

```bash
# å®Ÿéš›ã®è¨­å®šä¾‹ï¼ˆã‚­ãƒ¼ã¯ä»®æƒ³ï¼‰
ALPHA_VANTAGE_API_KEY=ABC123XYZ789
COINGECKO_API_KEY=CG-xyz789abc123
FRED_API_KEY=fred123abc789xyz
REAL_DATA_MODE=true
DEBUG_API=false
```

---

## ğŸ§ª **æ¥ç¶šãƒ†ã‚¹ãƒˆ**

### **1. ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ**

`src/scripts/test-api-connections.ts` ã‚’ä½œæˆï¼š

```typescript
#!/usr/bin/env tsx
import dotenv from 'dotenv';
import axios from 'axios';

// .env.local ã®èª­ã¿è¾¼ã¿
dotenv.config({ path: '.env.local' });

interface TestResult {
  service: string;
  success: boolean;
  message: string;
  data?: any;
}

async function testAlphaVantage(): Promise<TestResult> {
  const apiKey = process.env.ALPHA_VANTAGE_API_KEY;
  
  if (!apiKey) {
    return { service: 'Alpha Vantage', success: false, message: 'APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“' };
  }
  
  try {
    const response = await axios.get(
      `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=AAPL&apikey=${apiKey}`,
      { timeout: 10000 }
    );
    
    if (response.data['Global Quote']) {
      return { 
        service: 'Alpha Vantage', 
        success: true, 
        message: 'æ¥ç¶šæˆåŠŸ', 
        data: response.data['Global Quote']['05. price']
      };
    } else {
      return { service: 'Alpha Vantage', success: false, message: 'ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒä¸æ­£ã§ã™' };
    }
  } catch (error) {
    return { 
      service: 'Alpha Vantage', 
      success: false, 
      message: `æ¥ç¶šå¤±æ•—: ${error.message}` 
    };
  }
}

async function testCoinGecko(): Promise<TestResult> {
  const apiKey = process.env.COINGECKO_API_KEY;
  
  if (!apiKey) {
    return { service: 'CoinGecko', success: false, message: 'APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“' };
  }
  
  try {
    const response = await axios.get(
      'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd',
      { 
        headers: { 'x-cg-demo-api-key': apiKey },
        timeout: 10000 
      }
    );
    
    if (response.data.bitcoin?.usd) {
      return { 
        service: 'CoinGecko', 
        success: true, 
        message: 'æ¥ç¶šæˆåŠŸ',
        data: `Bitcoin: $${response.data.bitcoin.usd}`
      };
    } else {
      return { service: 'CoinGecko', success: false, message: 'ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒä¸æ­£ã§ã™' };
    }
  } catch (error) {
    return { 
      service: 'CoinGecko', 
      success: false, 
      message: `æ¥ç¶šå¤±æ•—: ${error.message}` 
    };
  }
}

async function testFRED(): Promise<TestResult> {
  const apiKey = process.env.FRED_API_KEY;
  
  if (!apiKey) {
    return { service: 'FRED', success: false, message: 'APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“' };
  }
  
  try {
    const response = await axios.get(
      `https://api.stlouisfed.org/fred/series/observations?series_id=GDP&api_key=${apiKey}&file_type=json&limit=1&sort_order=desc`,
      { timeout: 15000 }
    );
    
    if (response.data.observations?.length > 0) {
      return { 
        service: 'FRED', 
        success: true, 
        message: 'æ¥ç¶šæˆåŠŸ',
        data: `GDP: ${response.data.observations[0].value}`
      };
    } else {
      return { service: 'FRED', success: false, message: 'ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã¾ã›ã‚“' };
    }
  } catch (error) {
    return { 
      service: 'FRED', 
      success: false, 
      message: `æ¥ç¶šå¤±æ•—: ${error.message}` 
    };
  }
}

async function runAllTests() {
  console.log('ğŸ§ª APIæ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹...\n');
  
  const tests = [
    testAlphaVantage(),
    testCoinGecko(),
    testFRED()
  ];
  
  const results = await Promise.all(tests);
  
  console.log('ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœ:');
  console.log('=' .repeat(50));
  
  let successCount = 0;
  
  for (const result of results) {
    const status = result.success ? 'âœ…' : 'âŒ';
    console.log(`${status} ${result.service}: ${result.message}`);
    if (result.data) {
      console.log(`   ğŸ“„ ãƒ‡ãƒ¼ã‚¿ä¾‹: ${result.data}`);
    }
    if (result.success) successCount++;
  }
  
  console.log('=' .repeat(50));
  console.log(`ğŸ“ˆ æˆåŠŸç‡: ${successCount}/${results.length} (${Math.round(successCount/results.length*100)}%)`);
  
  if (successCount === results.length) {
    console.log('ğŸ‰ å…¨ã¦ã®APIæ¥ç¶šãŒæˆåŠŸã—ã¾ã—ãŸï¼æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚ã¾ã™ã€‚');
  } else {
    console.log('âš ï¸  ä¸€éƒ¨ã®APIæ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
  }
}

// ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
runAllTests().catch(console.error);
```

### **2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**

```bash
# å®Ÿè¡Œæ¨©é™ä»˜ä¸
chmod +x src/scripts/test-api-connections.ts

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm exec tsx src/scripts/test-api-connections.ts
```

### **3. æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**

```bash
ğŸ§ª APIæ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹...

ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœ:
==================================================
âœ… Alpha Vantage: æ¥ç¶šæˆåŠŸ
   ğŸ“„ ãƒ‡ãƒ¼ã‚¿ä¾‹: 180.25
âœ… CoinGecko: æ¥ç¶šæˆåŠŸ
   ğŸ“„ ãƒ‡ãƒ¼ã‚¿ä¾‹: Bitcoin: $43,250
âœ… FRED: æ¥ç¶šæˆåŠŸ
   ğŸ“„ ãƒ‡ãƒ¼ã‚¿ä¾‹: GDP: 27000.456
==================================================
ğŸ“ˆ æˆåŠŸç‡: 3/3 (100%)
ğŸ‰ å…¨ã¦ã®APIæ¥ç¶šãŒæˆåŠŸã—ã¾ã—ãŸï¼æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚ã¾ã™ã€‚
```

---

## âŒ **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**

### **å•é¡Œ1: APIã‚­ãƒ¼ãŒç„¡åŠ¹**
```bash
âŒ Alpha Vantage: æ¥ç¶šå¤±æ•—: Request failed with status code 403
```

**è§£æ±ºæ–¹æ³•**:
1. APIã‚­ãƒ¼ãŒæ­£ã—ãã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. APIã‚­ãƒ¼ã®æœ‰åŠ¹æ€§ã‚’å„ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç¢ºèª
3. ä½¿ç”¨åˆ¶é™ã«é”ã—ã¦ã„ãªã„ã‹ç¢ºèª

### **å•é¡Œ2: ç’°å¢ƒå¤‰æ•°ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„**
```bash
âŒ Alpha Vantage: APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“
```

**è§£æ±ºæ–¹æ³•**:
1. `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹ã‹ç¢ºèª
2. ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã«ä½™åˆ†ãªã‚¹ãƒšãƒ¼ã‚¹ã‚„æ”¹è¡ŒãŒãªã„ã‹ç¢ºèª
3. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªï¼š
   ```bash
   node -e "require('dotenv').config({path: '.env.local'}); console.log(process.env.ALPHA_VANTAGE_API_KEY)"
   ```

### **å•é¡Œ3: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚¨ãƒ©ãƒ¼**
```bash
âŒ FRED: æ¥ç¶šå¤±æ•—: connect ECONNREFUSED
```

**è§£æ±ºæ–¹æ³•**:
1. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèª
2. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’ç¢ºèª
3. ãƒ—ãƒ­ã‚­ã‚·è¨­å®šãŒå¿…è¦ãªå ´åˆã¯è¨­å®š

### **å•é¡Œ4: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼**
```bash
âŒ CoinGecko: æ¥ç¶šå¤±æ•—: Request failed with status code 429
```

**è§£æ±ºæ–¹æ³•**:
1. å°‘ã—æ™‚é–“ã‚’ãŠã„ã¦å†å®Ÿè¡Œ
2. APIã®ä½¿ç”¨åˆ¶é™ã‚’ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰

---

## âœ… **å®Œäº†ç¢ºèª**

ä»¥ä¸‹ãŒå…¨ã¦ âœ… ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

- [ ] Alpha Vantage APIã‚­ãƒ¼å–å¾—ãƒ»è¨­å®šå®Œäº†
- [ ] CoinGecko APIã‚­ãƒ¼å–å¾—ãƒ»è¨­å®šå®Œäº†  
- [ ] FRED APIã‚­ãƒ¼å–å¾—ãƒ»è¨­å®šå®Œäº†
- [ ] `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãƒ»æ¨©é™è¨­å®šå®Œäº†
- [ ] ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆãƒ»å®Ÿè¡Œå®Œäº†
- [ ] å…¨APIæ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª

**å…¨ã¦å®Œäº†ã—ãŸã‚‰æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã€Œã‚³ãƒ¼ãƒ‰å¤‰æ›´å®Ÿè£…ã€ã«é€²ã‚“ã§ãã ã•ã„ã€‚**

---

## ğŸ“ **ã‚µãƒãƒ¼ãƒˆæƒ…å ±**

### **å„APIã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
- Alpha Vantage: https://www.alphavantage.co/documentation/
- CoinGecko: https://www.coingecko.com/en/api/documentation
- FRED: https://fred.stlouisfed.org/docs/api/

### **åˆ¶é™äº‹é …**:
- Alpha Vantage: 5 requests/åˆ†ã€500 requests/æ—¥
- CoinGecko (ç„¡æ–™): 30 requests/åˆ†
- FRED: 120 requests/åˆ†

**ã“ã®æ‰‹é †æ›¸ã«å¾“ã£ã¦è¨­å®šã™ã‚‹ã“ã¨ã§ã€å¤–éƒ¨APIã¨ã®æ¥ç¶šãŒç¢ºç«‹ã•ã‚Œã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿åé›†ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚**