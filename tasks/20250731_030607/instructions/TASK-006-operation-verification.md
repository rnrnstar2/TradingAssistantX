# TASK-006: 動作確認テスト

## 🎯 タスク概要

TypeScriptエラー修正後、深夜分析機能を含むシステム全体の動作確認を実施します。通常のワークフロー実行と深夜分析の基本動作を検証します。

## 📋 前提条件

- **TASK-005完了**: TypeScriptエラーが解消されていること
- **環境変数設定**: `.env`ファイルに必要な環境変数が設定済み
- **依存関係**: `npm install`実行済み

## 🧪 テスト項目

### 1. 基本動作確認

#### TypeScriptコンパイル確認
```bash
npx tsc --noEmit
```
**期待結果**: エラーなしでコンパイル成功

#### 開発モード起動確認
```bash
npm run dev
```
**期待結果**: 
- ワークフロー正常起動
- KaitoApiClient初期化成功
- 適切なログ出力

### 2. 通常アクション動作確認

#### 投稿アクション（参考ツイート付き）
```bash
# dev.tsでpost アクション実行（target_query付き）
npm run dev
```
**確認項目**:
- 参考ツイート検索ログ確認
- コンテンツ生成成功
- エラーなし

### 3. 深夜分析機能確認

#### analyzeアクション単体テスト
main-workflow.ts内のexecuteAnalyzeActionを直接呼び出すテストスクリプト作成：

```typescript
// test-analyze.ts
import { MainWorkflow } from './src/workflows/main-workflow';

const testDecision = {
  action: 'analyze',
  parameters: {},
  confidence: 1.0,
  reasoning: 'テスト実行'
};

// executeAnalyzeActionを呼び出し
```

**確認項目**:
- 投稿メトリクス収集成功
- Claude分析実行完了
- 分析結果ログ出力
- エラーハンドリング動作

### 4. ログ出力確認

#### 期待されるログシーケンス
```
🚀 メインワークフロー実行開始
✅ KaitoApiClient初期化完了
🌙 深夜分析アクション実行開始
📊 投稿メトリクス収集中...
📊 投稿メトリクス収集完了: XX件
🧠 Claude分析実行中...
🧠 Claude分析実行完了
💾 分析結果保存中...
✅ 深夜分析アクション完了
```

### 5. エラーケース確認

#### KaitoAPI接続エラー
- API認証失敗時のフォールバック動作
- デフォルト値での継続実行

#### Claude API タイムアウト
- 60秒タイムアウト動作確認
- エラーメッセージ適切性

## 📊 テスト結果記録

### 実行環境
- Node.js バージョン: 
- TypeScript バージョン:
- 実行日時:

### テスト結果サマリ
| テスト項目 | 結果 | 備考 |
|-----------|------|------|
| TypeScriptコンパイル | ⚪/✖ | |
| 通常ワークフロー | ⚪/✖ | |
| 参考ツイート機能 | ⚪/✖ | |
| 深夜分析実行 | ⚪/✖ | |
| エラーハンドリング | ⚪/✖ | |

## 🐛 発見した問題

### 問題1
- **現象**:
- **原因**:
- **対処**:

## ✅ 完成基準

1. **全テスト項目パス**: 上記テスト項目が全て正常動作
2. **ログ一貫性**: 期待されるログが適切に出力
3. **エラーなし**: 予期しないエラーが発生しない
4. **既存機能維持**: 通常のワークフローに影響なし

## 📄 報告書要件

実装完了後、以下を`tasks/20250731_030607/reports/REPORT-006-operation-verification.md`に記載：

1. **テスト環境**: 実行環境の詳細
2. **テスト結果**: 各テスト項目の成功/失敗
3. **ログサンプル**: 主要な実行ログの抜粋
4. **問題と対策**: 発見した問題と解決方法
5. **動作確認**: スクリーンショットやログ出力
6. **次ステップ**: 本番環境への移行準備状況

## 🚨 注意事項

- **実データ注意**: テスト時は本番APIを使用するため注意
- **レート制限**: API呼び出し回数に注意
- **ログ記録**: エラー発生時は詳細ログを保存