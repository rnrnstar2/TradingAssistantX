# 深夜分析結果の位置づけ修正指示書

## タスク概要
docs/deep-night-analysis.mdの「翌日戦略生成」ニュアンスを修正し、schedule.yamlは変更せず、strategy-analysis.yamlを参考データとして保存・活用する方式に変更する。

## 修正対象ファイル
- docs/deep-night-analysis.md

## 修正項目

### 1. 概要セクションの修正（7行目）
**現在**:
```
毎日23:55に実行され、最新50件の投稿のエンゲージメントを分析し、翌日の投稿戦略を自動生成します。
```
**修正後**:
```
毎日23:55に実行され、最新50件の投稿のエンゲージメントを分析し、投稿戦略の参考データを生成・保存します。
```

### 2. 実行スケジュール表の修正（26行目）
**現在**:
```
| **次回適用** | 翌日07:00以降のワークフローから自動適用 |
```
**修正後**:
```
| **データ活用** | 通常ワークフローでプロンプト変数として参照可能 |
```

### 3. analyzeアクション詳細の修正（workflow.md 95行目相当箇所）
**現在**:
```
**目的**: 1日分の実行データを包括分析し、翌日戦略を自動生成
```
**修正後**:
```
**目的**: 1日分の実行データを包括分析し、戦略参考データを生成・保存
```

### 4. strategy-analysis.yamlの説明修正
**現在の説明を以下に変更**:
```markdown
### strategy-analysis.yamlの位置づけ

深夜分析で生成される`strategy-analysis.yaml`は、**参考データとしての分析結果**です：

- **保存場所**: `data/current/strategy-analysis.yaml`
- **内容**: 投稿パフォーマンス分析、市場トレンド、最適化提案
- **活用方法**: 通常ワークフロー実行時にプロンプト変数として読み込み
- **更新頻度**: 毎日23:55の深夜分析で上書き更新

**重要**: schedule.yamlは変更されません。分析結果は参考データとして保存され、通常のワークフロー実行時にClaude SDKのプロンプト生成で活用されます。
```

### 5. 実行フロー説明の修正
**「翌日戦略生成」を以下に変更**:
```
戦略参考データ生成
├─ strategy-analysis.yaml（分析結果）
└─ learning/配下の累積更新
```

### 6. 期待される成果の修正
**現在**:
```
- **次回適用**: 翌日07:00以降のワークフローから自動適用
```
**修正後**:
```
- **データ活用**: 通常ワークフロー実行時にプロンプト変数として参照・活用
```

### 7. 活用方法の具体例追加
以下のセクションを新規追加：
```markdown
## 💡 分析結果の活用方法

### プロンプト変数としての活用
通常のワークフロー実行時、Claude SDKのプロンプト生成で以下のように活用されます：

```typescript
// プロンプト生成時に分析結果を読み込み
const strategyData = await this.dataManager.loadStrategyAnalysis();

const promptContext = {
  // 通常のコンテキスト
  timeSlot: currentTimeSlot,
  topic: actionTopic,
  
  // 深夜分析結果を参考データとして追加
  recommendations: strategyData?.postOptimization?.recommendedTopics || [],
  bestTimeSlots: strategyData?.performancePatterns || [],
  avoidTopics: strategyData?.postOptimization?.avoidTopics || []
};
```

**活用効果**:
- **コンテンツ最適化**: 高パフォーマンストピックの優先選択
- **時間帯最適化**: 成功率の高い時間帯での投稿強化
- **リスク回避**: 低パフォーマンストピックの回避
```

## 修正方針

### 基本原則
- schedule.yamlは変更しない（固定設定）
- 深夜分析は「分析結果保存」が目的
- strategy-analysis.yamlは「参考データ」
- 通常ワークフローで「プロンプト変数として活用」

### 統一表現
- 「翌日戦略生成」→「戦略参考データ生成」
- 「自動適用」→「プロンプト変数として活用」
- 「戦略最適化」→「分析結果保存」

## 確認事項
- schedule.yamlの変更に関する記述が削除されているか
- strategy-analysis.yamlが参考データとして位置づけられているか
- プロンプト変数としての活用方法が説明されているか