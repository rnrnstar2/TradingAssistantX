# TASK-004: schedule.yaml最適化 - リアルタイム情報取得の強化

## 📋 タスク概要
schedule.yamlの検索クエリを最適化し、よりリアルタイムで価値の高い情報を取得できるようにする。

## 🎯 実装目標
1. 既存の改善内容の確認と検証
2. 追加改善可能な箇所の特定
3. 高エンゲージメント・高品質コンテンツの効率的な取得

## 📝 現状確認

### 既に実装済みの改善点
schedule.yamlには以下の改善が既に適用されています：

1. **エンゲージメントフィルター**
   - `min_retweets:10`, `min_retweets:20`, `min_retweets:30`, `min_retweets:50`
   - `min_faves:20`, `min_faves:30`, `min_faves:50`

2. **品質フィルター**
   - `filter:verified` - 認証済みアカウントのみ
   - `filter:news` - ニュースリンク付き
   - `filter:has_engagement` - エンゲージメントありのツイート

3. **除外フィルター**
   - `-RT` - リツイート除外
   - `-PR -広告` - プロモーション除外
   - `-filter:replies` - リプライ除外

4. **複合検索クエリ**
   - OR演算子を使った複数キーワード検索
   - 時事性の高いキーワード（日銀、FRB、ECB、AI、DX、ESG等）

## 🛠️ 追加実装内容

### 1. 時間指定フィルターの追加（重要な時間帯のみ）
以下の重要な時間帯の投稿に、within_time演算子を追加：

```yaml
# 例: 朝の市場チェック時（9:00）
- time: "09:00"
  action: "post"
  topic: "市場オープン！今日の投資戦略"
  target_query: "(日経平均 OR ドル円 OR 米国株) within_time:3h min_retweets:20"
  # 3時間以内の最新情報を取得

# 例: 昼の市場動向（12:00）
- time: "12:00"
  action: "post"
  topic: "昼休みに学ぶ投資の基本"
  target_query: "投資 OR 株 OR 為替 within_time:2h filter:has_engagement"
  # 2時間以内のエンゲージメントのあるツイート

# 例: 夜のまとめ（20:00）
- time: "20:00"
  action: "post"
  topic: "今日の市場ニュースまとめと明日の注目点"
  target_query: "市場 (まとめ OR 総括) today within_time:6h filter:verified min_retweets:50"
  # 6時間以内の検証済みアカウントによるまとめ
```

### 2. 新規追加する高頻度チェックポイント

```yaml
# 米国市場開始前（22:30）
- time: "22:30"
  action: "post"
  topic: "米国市場開始前チェック"
  target_query: "(NYSE OR NASDAQ OR ダウ OR S&P) (予想 OR 見通し) within_time:2h min_faves:30"
  # 米国市場に関する最新予想

# 重要指標発表後（適宜追加）
- time: "10:30"
  action: "quote_tweet"
  target_query: "(GDP OR CPI OR 雇用統計) 発表 within_time:1h filter:news min_retweets:50"
  topic: "経済指標の読み方と投資への活用"
  # 指標発表直後の速報に解説を追加
```

### 3. 検索クエリのさらなる最適化提案

#### 朝の時間帯（6:00-9:00）
- `within_time:12h` - 前日夜からの重要ニュースをカバー
- 海外市場の動向を含むクエリを強化

#### 日中（9:00-15:00）
- `within_time:2h` - リアルタイム性を重視
- 市場の動きに関連するクエリを増強

#### 夕方〜夜（17:00-22:00）
- `within_time:6h` - 1日のまとめと翌日の準備
- 分析・解説系のコンテンツを重視

### 4. 実装上の注意事項
- **API制限**: within_timeフィルターは負荷が高いため、重要な時間帯のみ使用
- **バランス**: リアルタイム情報と教育的コンテンツのバランスを維持
- **フォールバック**: フィルターが厳しすぎて結果が0件になる場合の対策

## 🚫 制約事項
- schedule.yamlの基本構造は変更しない
- 1日のアクション数は現状維持
- 既存の時間割は大きく変更しない

## 📊 期待される効果
- より新鮮な市場情報の取得
- トレンドへの迅速な対応
- フォロワーへの価値提供向上
- エンゲージメント率の改善

## 📝 検証事項
実装後は以下を確認してください：
1. 各クエリで適切な数の結果が取得できるか
2. 取得したツイートの品質・鮮度は向上したか
3. API制限に抵触していないか
4. システム全体のパフォーマンスに影響はないか