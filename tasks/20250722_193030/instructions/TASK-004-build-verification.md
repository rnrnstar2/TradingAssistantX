# Task: ビルド確認と最終調整

## 概要
srcディレクトリ再編成の最終段階として、ビルドの成功確認と必要な調整を行います。

## 前提条件
- Phase 1〜3（TASK-001〜003）が完了していること
- ファイル削除、移動、import更新が完了していること

## 実施項目

### Step 1: TypeScript型チェック
```bash
pnpm run typecheck
```

エラーが発生した場合：
1. エラーメッセージを記録
2. 該当ファイルのimport文を確認
3. 必要に応じて修正

### Step 2: ESLintチェック
```bash
pnpm run lint
```

エラーが発生した場合：
1. import順序の問題は自動修正可能なら修正
2. その他のエラーは内容を確認して修正

### Step 3: プロジェクト全体のビルド確認
```bash
# TypeScriptコンパイル確認
npx tsc --noEmit

# 開発モードでの起動確認
pnpm run dev
```

### Step 4: 追加の確認事項

#### 4.1 package.jsonのパスエイリアス確認
package.jsonやtsconfig.jsonにパスエイリアスがある場合、更新が必要か確認

#### 4.2 テストファイルの確認
もしテストファイルが存在する場合：
- テストファイル内のimport文も更新されているか確認
- テストの実行確認

#### 4.3 ドキュメントの更新
READMEやその他のドキュメントにファイルパスの記載がある場合、更新が必要か確認

### Step 5: 最終レポートの作成

以下の内容を含む最終レポートを作成：

1. **削除したファイル**
   - ファイル名とパス
   - 削除理由

2. **移動したファイル**
   - 移動前後のパス対応表
   - 移動したファイル総数

3. **更新したimport文**
   - 更新したファイル数
   - 主要な更新パターン

4. **ビルド結果**
   - TypeScriptチェック結果
   - ESLintチェック結果
   - 実行確認結果

5. **改善効果**
   - ディレクトリ構造の明確化
   - 保守性の向上点

## エラー対応ガイド

### よくあるエラーと対処法

1. **Module not found エラー**
   - import文のパスを再確認
   - ファイルが正しい場所に移動されているか確認

2. **Circular dependency エラー**
   - 循環参照を特定
   - 必要に応じてファイル構造を見直し

3. **Type export エラー**
   - 型定義のexport/importが正しいか確認
   - 必要に応じて`export type`を使用

## 品質基準
- pnpm run typecheckがエラーなく完了すること
- pnpm run lintがエラーなく完了すること
- pnpm run devで正常に起動すること
- すべての機能が正常に動作すること

## 出力
- 最終レポート: `tasks/20250722_193030/outputs/phase4-final-report.md`
- エラーログ（もしあれば）: `tasks/20250722_193030/outputs/phase4-build-errors.log`

## 注意事項
- ビルドエラーは必ず解決してから完了とする
- 一時的な回避策（any型の使用等）は避ける
- 新しいディレクトリ構造が将来の拡張に対応できることを確認

## 完了チェックリスト
- [ ] TypeScriptチェック成功
- [ ] ESLintチェック成功
- [ ] 開発モード起動確認
- [ ] すべてのimport文が正しく解決
- [ ] 最終レポート作成完了